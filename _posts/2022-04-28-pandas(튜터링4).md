---
title: "튜터링 4일차(Pandas 기초, 실습 문제)"
excerpt_separator: "<!--more-->"
categories:

  - Post Formats

tags:

  - python
  - 튜터링
---





# heatmap (주류 데이터 상관관계)


```python
import pandas as pd
url = 'https://raw.githubusercontent.com/justmarkham/DAT8/master/data/drinks.csv'
drink_df = pd.read_csv(url, ',')
```

    D:\anaconda3\lib\site-packages\IPython\core\interactiveshell.py:3444: FutureWarning: In a future version of pandas all arguments of read_csv except for the argument 'filepath_or_buffer' will be keyword-only
      exec(code_obj, self.user_global_ns, self.user_ns)



```python
drink_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>beer_servings</th>
      <th>spirit_servings</th>
      <th>wine_servings</th>
      <th>total_litres_of_pure_alcohol</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>AS</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Albania</td>
      <td>89</td>
      <td>132</td>
      <td>54</td>
      <td>4.9</td>
      <td>EU</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Algeria</td>
      <td>25</td>
      <td>0</td>
      <td>14</td>
      <td>0.7</td>
      <td>AF</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Andorra</td>
      <td>245</td>
      <td>138</td>
      <td>312</td>
      <td>12.4</td>
      <td>EU</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Angola</td>
      <td>217</td>
      <td>57</td>
      <td>45</td>
      <td>5.9</td>
      <td>AF</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>188</th>
      <td>Venezuela</td>
      <td>333</td>
      <td>100</td>
      <td>3</td>
      <td>7.7</td>
      <td>SA</td>
    </tr>
    <tr>
      <th>189</th>
      <td>Vietnam</td>
      <td>111</td>
      <td>2</td>
      <td>1</td>
      <td>2.0</td>
      <td>AS</td>
    </tr>
    <tr>
      <th>190</th>
      <td>Yemen</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0.1</td>
      <td>AS</td>
    </tr>
    <tr>
      <th>191</th>
      <td>Zambia</td>
      <td>32</td>
      <td>19</td>
      <td>4</td>
      <td>2.5</td>
      <td>AF</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Zimbabwe</td>
      <td>64</td>
      <td>18</td>
      <td>4</td>
      <td>4.7</td>
      <td>AF</td>
    </tr>
  </tbody>
</table>
<p>193 rows X 6 columns</p>

</div>




```python
drink_df.columns
```




    Index(['country', 'beer_servings', 'spirit_servings', 'wine_servings',
           'total_litres_of_pure_alcohol', 'continent'],
          dtype='object')




```python
cols = ['beer_servings', 'spirit_servings', 'wine_servings', 'total_litres_of_pure_alcohol']
corr = drink_df[cols].corr(method='pearson')
corr
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>beer_servings</th>
      <th>spirit_servings</th>
      <th>wine_servings</th>
      <th>total_litres_of_pure_alcohol</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>beer_servings</th>
      <td>1.000000</td>
      <td>0.458819</td>
      <td>0.527172</td>
      <td>0.835839</td>
    </tr>
    <tr>
      <th>spirit_servings</th>
      <td>0.458819</td>
      <td>1.000000</td>
      <td>0.194797</td>
      <td>0.654968</td>
    </tr>
    <tr>
      <th>wine_servings</th>
      <td>0.527172</td>
      <td>0.194797</td>
      <td>1.000000</td>
      <td>0.667598</td>
    </tr>
    <tr>
      <th>total_litres_of_pure_alcohol</th>
      <td>0.835839</td>
      <td>0.654968</td>
      <td>0.667598</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
corr_column_names = ['beer', 'spirit', 'wine', 'alcohol']
```


```python
# heatmap
import seaborn as sns
import matplotlib.pyplot as plt
sns.set(font_scale=1.5)
hm = sns.heatmap(corr.values,
                    cbar=True,  #오른쪽에 있는 막대(범주)를 표시
                    annot=True,  #상관계수를 표시
                    square=True, # 정사각형으로 지정하는 것이며, False로 설정 시 직사각형이 됨
                    fmt='.2f', #상관계수의 소수점 자리수를 지정
                    annot_kws={'size': 15}, # 상관계수의 글자 크기를 지정
                    yticklabels=corr_column_names, # y축 레이블 값
                    xticklabels=corr_column_names) # x축 레이블 값
plt.title('Drink Correlation Coefficient')
plt.tight_layout()
plt.show()

"""
피어슨의 상관계수는 일반적으로
-값이 -1.0 ~ -0.7 이면, 강한 음적 상관관계
-값이 -0.7 ~ -0.3 이면, 뚜렷한 음적 상관관계
-값이 -0.3 ~ -0.1 이면, 약한 음적 상관관계
-값이 -0.1 ~ +0.1 이면, 없다고 할 수 있는 상관관계
-값이 +0.1 ~ +0.3 이면, 약한 양적 상관관계
-값이 +0.3 ~ +0.7 이면, 뚜렷한 양적 상관관계
-값이 +0.7 ~ +1.0 이면, 강한 양적 상관관계
"""
```

?    
![png](\github_img\output_6_0.png)
?    








```python
# pairplot ??
sns.set(style='whitegrid')
sns.pairplot(drink_df[['beer_servings', 'spirit_servings', 
                     'wine_servings', 'total_litres_of_pure_alcohol']],kind='reg')
#plt.title('Drink Pair Plot')
plt.show()
```

?    
![png](\github_img\output_7_0.png)
?    

#### 다른 시각화 방법 (https://dining-developer.tistory.com/30) 참고

# 실습 Merge & KRX API 활용 스크래핑

 - https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html 참고
- DataFrame.merge(right, how='inner', on=None, left_on=None, right_on=None, left_index=False, right_index=False, sort=False, suffixes=('_x', '_y'), copy=True, indicator=False, validate=None)
- KRX 스크래핑 정리된 깃허브 https://github.com/sharebook-kr/pykrx 참고

### 2.0.1 실습

- 참고 스크래핑을 많이 할 시(반복문)에는 time.sleep(1)을 주어 아이피 차단 당하지 않도록 주의한다.
- KRX 스크래핑을 활용하여 2020년 4월 20일에 KOSPI 시장의 티커를 받아오기.

1. 티커 중 앞에서 10번째부터 20번째까지 티커 ticker 저장하기
2. ticker-> 2020년 4월 (시가/고가/저가/종가/거래량)정보 받아와 df_ohlcv 저장하기 (칼럼은 날짜/시가/고가/저가/종가/거래량/티커)
3. ticker-> 2020년 4월 20일 (PER/EPS/PBR)정보 받아와 df_fundamental 저장하기 (칼럼 PER/EPS/PBR/티커)
4. df_fundamental에서 각 종목별로 그래프 그려보기
5. get_market_trading_volume_by_date을 활용하여 거래 실적 중 (4월 한달) 연기금 데이터 받아오고 df_purchases_of_equities에 저장
6. df_purchases_of_equities의 칼럼을 ['연기금','외국인','은행'] 저장하기
7. 코스피 200 ohlcv 받아와 종가 컬럼만 df에 저장
8. df와 df_purchases_of_equities를 df_last합치기
9. 히트맵 그려보기
10. 한 곳에 두개 그래프 겹쳐서 그려보기 (종가, 외국인) (양쪽에 y 범위나오게)
11. minmax 보기
12. df_last 에서 연금 칼럼 내림차순으로 정렬 해보기
13. 화살표 그리는 것 보기
14. csv 파일로 저장해 보기 , 불러와 보기


```python
# pykrx 설치
!pip install pykrx
```



```python
from pykrx import stock
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.patches as patches
```


```python
# 코스피 티커 받아오기
tickers = stock.get_market_ticker_list("20200401", market="KOSPI")
```




```python
# 티커 10이상 20미만 뽑아 내기
tickers[10:20]
```




    ['000120',
     '011150',
     '011155',
     '001045',
     '097950',
     '097955',
     '000590',
     '012030',
     '016610',
     '005830']




```python
# get_market_ohlcv 이용해서(티커 10개) 20200401~ 20200430까지 데이터 받아오기 
df_ohlcv = pd.DataFrame()
for i in tickers[10:20]:
    df = stock.get_market_ohlcv("20200401", "20200430", i)
    df['종목코드'] = i
    df_ohlcv = pd.concat([df_ohlcv, df] , axis=0)
df_ohlcv
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>



<table border="1" class="dataframe">  
    <thead>    
        <tr style="text-align: right;">      
            <th></th>      
            <th>시가</th>      
            <th>고가</th>      
            <th>저가</th>      
            <th>종가</th>      
            <th>거래량</th>      
            <th>종목코드</th>    
        </tr>    
        <tr>      
        <th>날짜</th>      
            <th></th>      
            <th></th>      
            <th></th>      
            <th></th>      
            <th></th>      
            <th></th>    
        </tr>  
    </thead>  
    <tbody>    
        <tr>      
            <th>2020-04-01</th>      
            <td>135500</td>      
            <td>136000</td>      
            <td>128000</td>      
            <td>128000</td>      
            <td>72016</td>      
            <td>000120</td>    
        </tr>    
        <tr>      
            <th>2020-04-02</th>      
            <td>129000</td>      
            <td>133000</td>      
            <td>126000</td>      <td>131000</td>      <td>68311</td>      <td>000120</td>    </tr>    <tr>      <th>2020-04-03</th>      <td>130000</td>      <td>130500</td>      <td>125500</td>      <td>127000</td>      <td>105709</td>      <td>000120</td>    </tr>    <tr>      <th>2020-04-06</th>      <td>128500</td>      <td>131500</td>      <td>127500</td>      <td>131500</td>      <td>74357</td>      <td>000120</td>    </tr>    <tr>      <th>2020-04-07</th>      <td>133000</td>      <td>136000</td>      <td>131500</td>      <td>135000</td>      <td>93191</td>      <td>000120</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>2020-04-23</th>      <td>40900</td>      <td>43600</td>      <td>40900</td>      <td>43100</td>      <td>346294</td>      <td>005830</td>    </tr>    <tr>      <th>2020-04-24</th>      <td>43900</td>      <td>44350</td>      <td>42000</td>      <td>42500</td>      <td>245584</td>      <td>005830</td>    </tr>    <tr>      <th>2020-04-27</th>      <td>43100</td>      <td>45400</td>      <td>42900</td>      <td>45100</td>      <td>262434</td>      <td>005830</td>    </tr>    <tr>      <th>2020-04-28</th>      <td>45000</td>      <td>45550</td>      <td>44550</td>      <td>44900</td>      <td>240765</td>      <td>005830</td>    </tr>    <tr>      <th>2020-04-29</th>      <td>45050</td>      <td>45500</td>      <td>44050</td>      <td>44150</td>      <td>279516</td>      <td>005830</td>    </tr>  </tbody></table><p>200 rows X 6 columns</p>



</div>




```python
# get_market_fundamental 이용해서 종목 코드별로  PER/EPS/PBR/티커 저장 4월 30일까지 
df_fundamental = pd.DataFrame()
for i in tickers[10:20]:
    df = stock.get_market_fundamental("20200401", "20200430", i)
    df = df[['PER','EPS','PBR']]
    df['종목코드'] = i
    df_fundamental = pd.concat([df_fundamental, df] , axis=0)
#     df_fundamental[['PER','EPS','PBR']]
#     df_fundamental.drop(['지워줄칼럼'],axis=1, inplace= True)
df_fundamental
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PER</th>
      <th>EPS</th>
      <th>PBR</th>
      <th>종목코드</th>
    </tr>
    <tr>
      <th>날짜</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-04-01</th>
      <td>64.13</td>
      <td>1996</td>
      <td>1.10</td>
      <td>000120</td>
    </tr>
    <tr>
      <th>2020-04-02</th>
      <td>65.63</td>
      <td>1996</td>
      <td>1.12</td>
      <td>000120</td>
    </tr>
    <tr>
      <th>2020-04-03</th>
      <td>63.63</td>
      <td>1996</td>
      <td>1.09</td>
      <td>000120</td>
    </tr>
    <tr>
      <th>2020-04-06</th>
      <td>65.88</td>
      <td>1996</td>
      <td>1.13</td>
      <td>000120</td>
    </tr>
    <tr>
      <th>2020-04-07</th>
      <td>67.64</td>
      <td>1996</td>
      <td>1.16</td>
      <td>000120</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020-04-23</th>
      <td>5.12</td>
      <td>8413</td>
      <td>0.60</td>
      <td>005830</td>
    </tr>
    <tr>
      <th>2020-04-24</th>
      <td>5.05</td>
      <td>8413</td>
      <td>0.59</td>
      <td>005830</td>
    </tr>
    <tr>
      <th>2020-04-27</th>
      <td>5.36</td>
      <td>8413</td>
      <td>0.63</td>
      <td>005830</td>
    </tr>
    <tr>
      <th>2020-04-28</th>
      <td>5.34</td>
      <td>8413</td>
      <td>0.62</td>
      <td>005830</td>
    </tr>
    <tr>
      <th>2020-04-29</th>
      <td>5.25</td>
      <td>8413</td>
      <td>0.61</td>
      <td>005830</td>
    </tr>
  </tbody>
</table>
<p>200 rows X 4 columns</p>

</div>




```python
# 종목 별로 종가 그래프 그려보기
for i in tickers[10:12] :
    plt.plot(df_ohlcv[df_ohlcv['회사코드'] == i].index, df_ohlcv[df_ohlcv['회사코드'] == i]['종가'])
    plt.xlabel(i)
    plt.show()
```

    findfont: Font family ['Malgun Gothic'] not found. Falling back to DejaVu Sans.




![png](\github_img\output_18_1.png)
    




![png](\github_img\output_18_2.png)
    




![png](\github_img\output_18_3.png)
    




![png](\github_img\output_18_4.png)
    




![png](\github_img\output_18_5.png)
    




![png](\github_img\output_18_6.png)
    




![png](\github_img\output_18_7.png)
    




![png](\github_img\output_18_8.png)
    




![png](\github_img\output_18_9.png)
    




![png](\github_img\output_18_10.png)
    



```python
# get_market_trading_volume_by_date 이용해서 연기금 데이터 받아오기
df_purchases_of_equities = stock.get_market_trading_volume_by_date("20200401", "20200430",  "KOSPI", etf=False, etn=False, elw=False, detail=True)
# df = stock.get_market_net_purchases_of_equities_by_ticker("20200401", "20200420",  "KOSPI","연기금")
df_purchases_of_equities = df_purchases_of_equities[['연기금','은행','외국인']]
df_purchases_of_equities
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>연기금</th>
      <th>은행</th>
      <th>외국인</th>
    </tr>
    <tr>
      <th>날짜</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-04-01</th>
      <td>-3853041</td>
      <td>-44504</td>
      <td>-23831466</td>
    </tr>
    <tr>
      <th>2020-04-02</th>
      <td>4498194</td>
      <td>-5148</td>
      <td>-8446659</td>
    </tr>
    <tr>
      <th>2020-04-03</th>
      <td>-1097980</td>
      <td>-68896</td>
      <td>-16630604</td>
    </tr>
    <tr>
      <th>2020-04-06</th>
      <td>4812420</td>
      <td>19599</td>
      <td>4014191</td>
    </tr>
    <tr>
      <th>2020-04-07</th>
      <td>-2530144</td>
      <td>-174506</td>
      <td>-12072491</td>
    </tr>
    <tr>
      <th>2020-04-08</th>
      <td>-1284245</td>
      <td>12106</td>
      <td>-258549</td>
    </tr>
    <tr>
      <th>2020-04-09</th>
      <td>-1563409</td>
      <td>-402558</td>
      <td>-9414818</td>
    </tr>
    <tr>
      <th>2020-04-10</th>
      <td>6563627</td>
      <td>112842</td>
      <td>-7537519</td>
    </tr>
    <tr>
      <th>2020-04-13</th>
      <td>2280334</td>
      <td>41108</td>
      <td>-14389369</td>
    </tr>
    <tr>
      <th>2020-04-14</th>
      <td>8657716</td>
      <td>46625</td>
      <td>11410336</td>
    </tr>
    <tr>
      <th>2020-04-16</th>
      <td>2708900</td>
      <td>-79976</td>
      <td>-18856436</td>
    </tr>
    <tr>
      <th>2020-04-17</th>
      <td>1887342</td>
      <td>64976</td>
      <td>11542658</td>
    </tr>
    <tr>
      <th>2020-04-20</th>
      <td>-1246400</td>
      <td>-55670</td>
      <td>-18952749</td>
    </tr>
    <tr>
      <th>2020-04-21</th>
      <td>108083</td>
      <td>-16041</td>
      <td>-26607729</td>
    </tr>
    <tr>
      <th>2020-04-22</th>
      <td>1476069</td>
      <td>-306354</td>
      <td>-4558558</td>
    </tr>
    <tr>
      <th>2020-04-23</th>
      <td>627870</td>
      <td>-66150</td>
      <td>-1393342</td>
    </tr>
    <tr>
      <th>2020-04-24</th>
      <td>-4699231</td>
      <td>-100415</td>
      <td>-25035025</td>
    </tr>
    <tr>
      <th>2020-04-27</th>
      <td>5705780</td>
      <td>53037</td>
      <td>22079667</td>
    </tr>
    <tr>
      <th>2020-04-28</th>
      <td>2586330</td>
      <td>-131259</td>
      <td>-7444783</td>
    </tr>
    <tr>
      <th>2020-04-29</th>
      <td>7795886</td>
      <td>44561</td>
      <td>2451745</td>
    </tr>
  </tbody>
</table>


</div>




```python
# get_index_ohlcv 이용해서 kospi 200 데이터 받아오기 kospi 200 코드는 "1028"
df = stock.get_index_ohlcv("20200401", "20200430", "1028")
print(df)
```

    코스피 200         시가      고가      저가      종가        거래량           거래대금
    날짜                                                                  
    2020-04-01  234.23  237.52  226.34  226.35  228582917  7913912554463
    2020-04-02  227.47  232.22  223.60  231.84  181789449  7548550111929
    2020-04-03  232.48  234.45  229.23  231.70  181037704  6313975247155
    2020-04-06  234.40  241.19  233.75  240.81  190735319  6552309976639
    2020-04-07  245.65  247.39  240.68  244.87  224450405  8030025997464
    2020-04-08  243.71  246.99  241.77  241.89  173124206  6327462222493
    2020-04-09  246.13  246.46  243.11  245.61  175943828  6264902174737
    2020-04-10  245.14  248.21  244.02  248.00  286111384  8017524561019
    2020-04-13  246.59  246.90  243.39  243.40  195898883  6122882379698
    2020-04-14  246.20  248.55  244.58  247.45  193118126  6324478963869
    2020-04-16  244.99  247.87  243.61  247.10  197540955  7080233242832
    2020-04-17  252.52  257.37  252.38  255.02  287358889  8845497222027
    2020-04-20  253.85  255.93  251.46  252.14  211000353  7086991401554
    2020-04-21  250.26  251.88  245.11  249.40  257155767  9189581681700
    2020-04-22  246.16  252.18  244.56  251.88  184498560  6416486137882
    2020-04-23  253.42  255.22  251.58  253.74  163807563  6790106157640
    2020-04-24  252.47  252.86  249.19  250.28  154306123  5580465389957
    2020-04-27  251.18  255.79  250.61  254.84  151357844  5410331030367
    2020-04-28  255.91  257.34  253.22  256.39  172425764  6016788152603
    2020-04-29  256.58  259.67  256.04  258.15  184478197  6586219380156



```python
# 종가, 연기금, 외국인, 은행 합치기
df_last = pd.concat([df['종가'],df_purchases_of_equities[['연기금','외국인','은행']]], axis = 1)
df_last
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종가</th>
      <th>연기금</th>
      <th>외국인</th>
      <th>은행</th>
    </tr>
    <tr>
      <th>날짜</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-04-01</th>
      <td>226.35</td>
      <td>-3853041</td>
      <td>-23831466</td>
      <td>-44504</td>
    </tr>
    <tr>
      <th>2020-04-02</th>
      <td>231.84</td>
      <td>4498194</td>
      <td>-8446659</td>
      <td>-5148</td>
    </tr>
    <tr>
      <th>2020-04-03</th>
      <td>231.70</td>
      <td>-1097980</td>
      <td>-16630604</td>
      <td>-68896</td>
    </tr>
    <tr>
      <th>2020-04-06</th>
      <td>240.81</td>
      <td>4812420</td>
      <td>4014191</td>
      <td>19599</td>
    </tr>
    <tr>
      <th>2020-04-07</th>
      <td>244.87</td>
      <td>-2530144</td>
      <td>-12072491</td>
      <td>-174506</td>
    </tr>
    <tr>
      <th>2020-04-08</th>
      <td>241.89</td>
      <td>-1284245</td>
      <td>-258549</td>
      <td>12106</td>
    </tr>
    <tr>
      <th>2020-04-09</th>
      <td>245.61</td>
      <td>-1563409</td>
      <td>-9414818</td>
      <td>-402558</td>
    </tr>
    <tr>
      <th>2020-04-10</th>
      <td>248.00</td>
      <td>6563627</td>
      <td>-7537519</td>
      <td>112842</td>
    </tr>
    <tr>
      <th>2020-04-13</th>
      <td>243.40</td>
      <td>2280334</td>
      <td>-14389369</td>
      <td>41108</td>
    </tr>
    <tr>
      <th>2020-04-14</th>
      <td>247.45</td>
      <td>8657716</td>
      <td>11410336</td>
      <td>46625</td>
    </tr>
    <tr>
      <th>2020-04-16</th>
      <td>247.10</td>
      <td>2708900</td>
      <td>-18856436</td>
      <td>-79976</td>
    </tr>
    <tr>
      <th>2020-04-17</th>
      <td>255.02</td>
      <td>1887342</td>
      <td>11542658</td>
      <td>64976</td>
    </tr>
    <tr>
      <th>2020-04-20</th>
      <td>252.14</td>
      <td>-1246400</td>
      <td>-18952749</td>
      <td>-55670</td>
    </tr>
    <tr>
      <th>2020-04-21</th>
      <td>249.40</td>
      <td>108083</td>
      <td>-26607729</td>
      <td>-16041</td>
    </tr>
    <tr>
      <th>2020-04-22</th>
      <td>251.88</td>
      <td>1476069</td>
      <td>-4558558</td>
      <td>-306354</td>
    </tr>
    <tr>
      <th>2020-04-23</th>
      <td>253.74</td>
      <td>627870</td>
      <td>-1393342</td>
      <td>-66150</td>
    </tr>
    <tr>
      <th>2020-04-24</th>
      <td>250.28</td>
      <td>-4699231</td>
      <td>-25035025</td>
      <td>-100415</td>
    </tr>
    <tr>
      <th>2020-04-27</th>
      <td>254.84</td>
      <td>5705780</td>
      <td>22079667</td>
      <td>53037</td>
    </tr>
    <tr>
      <th>2020-04-28</th>
      <td>256.39</td>
      <td>2586330</td>
      <td>-7444783</td>
      <td>-131259</td>
    </tr>
    <tr>
      <th>2020-04-29</th>
      <td>258.15</td>
      <td>7795886</td>
      <td>2451745</td>
      <td>44561</td>
    </tr>
  </tbody>
</table>


</div>




```python
# 위의 데이터프레임으로 히트맵 그려보기
import seaborn as sns
import matplotlib.pyplot as plt
# plt.rcParams['font.family'] = 'NanumGothic'
plt.rcParams['font.family'] ='Malgun Gothic'
# plt.rcParams['axes.unicode_minus'] = False

df_last_c = df_last.corr()
sns.heatmap(df_last_c ,annot=True )
```




    <AxesSubplot:>



?    
![png](\github_img\output_22_1.png)
?    



```python
# 두 그래프(종가, 외국인) 를 한 번에 그리기 y축 양쪽에 표시 되도록
import matplotlib.pyplot as plt

fig, ax1 = plt.subplots()
ax1.plot(df.index,df['종가'])

ax2 = ax1.twinx()
ax2.plot(df_last.index,df_last['외국인'], color = 'red')

plt.show()
```

?    
![png](\github_img\output_23_0.png)
?    



```python
from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler()
df_minmax = scaler.fit_transform(df_last)

df_last_df = pd.DataFrame(df_minmax, columns = ['종가', '연기금','외국인','은행'] ,index = df_last.index)
print(df_last_df)
```

                      종가       연기금       외국인        은행
    날짜                                                     
    2020-04-01  0.000000  0.063352  0.057022  0.694711
    2020-04-02  0.172642  0.688587  0.373014  0.771071
    2020-04-03  0.168239  0.269616  0.204922  0.647385
    2020-04-06  0.454717  0.712113  0.628950  0.819086
    2020-04-07  0.582390  0.162394  0.298542  0.442476
    2020-04-08  0.488679  0.255671  0.541191  0.804548
    2020-04-09  0.605660  0.234771  0.353129  0.000000
    2020-04-10  0.680818  0.843221  0.391687  1.000000
    2020-04-13  0.536164  0.522542  0.250955  0.860819
    2020-04-14  0.663522  1.000000  0.780861  0.871523
    2020-04-16  0.652516  0.554628  0.159205  0.625887
    2020-04-17  0.901572  0.493120  0.783578  0.907128
    2020-04-20  0.811006  0.258505  0.157227  0.673046
    2020-04-21  0.724843  0.359911  0.000000  0.749936
    2020-04-22  0.802830  0.462329  0.452872  0.186659
    2020-04-23  0.861321  0.398826  0.517883  0.652712
    2020-04-24  0.752516  0.000000  0.032302  0.586230
    2020-04-27  0.895912  0.778996  1.000000  0.883964
    2020-04-28  0.944654  0.545451  0.393592  0.526385
    2020-04-29  1.000000  0.935477  0.596858  0.867518



```python
import matplotlib.pyplot as plt

plt.plot(df_last_df.index,df_last_df['종가'])
plt.plot(df_last_df.index,df_last_df['외국인'], color = 'red')

plt.show()
```

?    
![png](\github_img\output_25_0.png)
?    



```python
# 연기금 칼럼 기준으로 내림차순 정렬하기
df_last.sort_values(['연기금'], ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종가</th>
      <th>연기금</th>
      <th>외국인</th>
      <th>은행</th>
    </tr>
    <tr>
      <th>날짜</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-04-14</th>
      <td>247.45</td>
      <td>8657716</td>
      <td>11410336</td>
      <td>46625</td>
    </tr>
    <tr>
      <th>2020-04-29</th>
      <td>258.15</td>
      <td>7795886</td>
      <td>2451745</td>
      <td>44561</td>
    </tr>
    <tr>
      <th>2020-04-10</th>
      <td>248.00</td>
      <td>6563627</td>
      <td>-7537519</td>
      <td>112842</td>
    </tr>
    <tr>
      <th>2020-04-27</th>
      <td>254.84</td>
      <td>5705780</td>
      <td>22079667</td>
      <td>53037</td>
    </tr>
    <tr>
      <th>2020-04-06</th>
      <td>240.81</td>
      <td>4812420</td>
      <td>4014191</td>
      <td>19599</td>
    </tr>
    <tr>
      <th>2020-04-02</th>
      <td>231.84</td>
      <td>4498194</td>
      <td>-8446659</td>
      <td>-5148</td>
    </tr>
    <tr>
      <th>2020-04-16</th>
      <td>247.10</td>
      <td>2708900</td>
      <td>-18856436</td>
      <td>-79976</td>
    </tr>
    <tr>
      <th>2020-04-28</th>
      <td>256.39</td>
      <td>2586330</td>
      <td>-7444783</td>
      <td>-131259</td>
    </tr>
    <tr>
      <th>2020-04-13</th>
      <td>243.40</td>
      <td>2280334</td>
      <td>-14389369</td>
      <td>41108</td>
    </tr>
    <tr>
      <th>2020-04-17</th>
      <td>255.02</td>
      <td>1887342</td>
      <td>11542658</td>
      <td>64976</td>
    </tr>
    <tr>
      <th>2020-04-22</th>
      <td>251.88</td>
      <td>1476069</td>
      <td>-4558558</td>
      <td>-306354</td>
    </tr>
    <tr>
      <th>2020-04-23</th>
      <td>253.74</td>
      <td>627870</td>
      <td>-1393342</td>
      <td>-66150</td>
    </tr>
    <tr>
      <th>2020-04-21</th>
      <td>249.40</td>
      <td>108083</td>
      <td>-26607729</td>
      <td>-16041</td>
    </tr>
    <tr>
      <th>2020-04-03</th>
      <td>231.70</td>
      <td>-1097980</td>
      <td>-16630604</td>
      <td>-68896</td>
    </tr>
    <tr>
      <th>2020-04-20</th>
      <td>252.14</td>
      <td>-1246400</td>
      <td>-18952749</td>
      <td>-55670</td>
    </tr>
    <tr>
      <th>2020-04-08</th>
      <td>241.89</td>
      <td>-1284245</td>
      <td>-258549</td>
      <td>12106</td>
    </tr>
    <tr>
      <th>2020-04-09</th>
      <td>245.61</td>
      <td>-1563409</td>
      <td>-9414818</td>
      <td>-402558</td>
    </tr>
    <tr>
      <th>2020-04-07</th>
      <td>244.87</td>
      <td>-2530144</td>
      <td>-12072491</td>
      <td>-174506</td>
    </tr>
    <tr>
      <th>2020-04-01</th>
      <td>226.35</td>
      <td>-3853041</td>
      <td>-23831466</td>
      <td>-44504</td>
    </tr>
    <tr>
      <th>2020-04-24</th>
      <td>250.28</td>
      <td>-4699231</td>
      <td>-25035025</td>
      <td>-100415</td>
    </tr>
  </tbody>
</table>

</div>




```python
# 정보 보기
df_last.info()
```

    <class 'pandas.core.frame.DataFrame'>
    DatetimeIndex: 20 entries, 2020-04-01 to 2020-04-29
    Data columns (total 4 columns):
     #   Column  Non-Null Count  Dtype  
    ---  ------  --------------  -----  
     0   종가      20 non-null     float64
     1   연기금     20 non-null     int64  
     2   외국인     20 non-null     int64  
     3   은행      20 non-null     int64  
    dtypes: float64(1), int64(3)
    memory usage: 800.0 bytes



```python
fig, ax = plt.subplots()

# 방법 1
ax.plot(df_last.index, df_last['연기금'])
plt.annotate("Here", xytext=(pd.to_datetime('2020-04-19'), 8657716), xy=(pd.to_datetime('2020-04-14'), 8657716), 
            arrowprops=dict(facecolor='black'))

# 방법 2
# arrow = patches.FancyArrowPatch((pd.to_datetime('2020-04-19'), 8657716),
#                                 (pd.to_datetime('2020-04-14'), 8657716),
#                                 mutation_scale =10,
#                                 color = 'red',
#                                 fill = True,
#                                 alpha =0.8)
# plt.gca().add_patch(arrow)
# plt.xlim(pd.to_datetime('2020-04-01'), pd.to_datetime('2020-04-20')) 

plt.show()
```


?    
![png](output_28_0.png)
?    



```python
# 두개의 그래프
fig, ax1 = plt.subplots()

ax1.plot(df.index,df['종가'])
ax1.annotate("2020-04-14", xy=(pd.to_datetime('2020-04-14'), df[df.index==pd.to_datetime('2020-04-14')]['종가']), xytext=(pd.to_datetime('2020-04-14'), df[df.index==pd.to_datetime('2020-04-14')]['종가']-20),
            arrowprops=dict(arrowstyle="->"))

ax2 = ax1.twinx()
ax2.plot(df_last.index,df_last['연기금'], color = 'red')
# ax1.plot(asd.index, asd['연기금'])
# plt.arrow( pd.to_datetime('2020-04-14'), 8657716 , 0.5, 0.5 ,head_width=0.15,  head_length=0.1)
ax2.annotate("2020-04-14", xy=(pd.to_datetime('2020-04-14'), 8657716), xytext=(pd.to_datetime('2020-04-14'), 2),
            arrowprops=dict(arrowstyle="->"))
plt.show()
```

?    
![png](\github_img\output_29_0.png)
?    


## scaler

1. Standard Scaler
- 기존 변수의 범위를 정규 분포로 변환하는 것.
- 데이터의 최소 최대를 모를 때 사용
- 모든 피처의 평균을 0, 분산을 1로 만듬
- 이상치가 있다면 평균과 표준편차에 영향을 미치기 때문에 데이터의 확산이 달라지게 됨
-  이상치가 많다면 사용하지 않는 것이 좋음 

2. Normalizer
- 각 변수의 값을 원점으로부터 1만큼 떨어져 있는 범위 내로 변환 
- 빠르게 학습할 수 있고 과대적합 확률을 낮출 수 있음
  
3. MinMaxScaler
- 데이터의 값들을 0~1 사이의 값으로 변환시키는 것
- 각 변수가 정규분포(bell-shape)가 아니거나 표준 편차가 작을 때 효과적
- BUT Standard Scaler와 같이 이상치 존재에 민감

4. Robust Scaler
- 모든 피처가 같은 크기를 갖는 다는 점이 standard와 유사 
- BUT 평균과 분산이 아닌 중위수(median)과 IQR(사분위수)를 사용함
- Standard scaler에 비해 이상치의 영향이 적어짐 




```python
import pandas as pd
import numpy as np

df = pd.DataFrame({'x1' : np.arange(11), 'x2' : np.arange(11) ** 2})
df
```





  <div id="df-0ac1b74a-85fd-4f7b-8e07-1516b2c62cb9">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>16</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>25</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>36</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>49</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>64</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>81</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>100</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-0ac1b74a-85fd-4f7b-8e07-1516b2c62cb9')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }
    
    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }
    
    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }
    
    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-0ac1b74a-85fd-4f7b-8e07-1516b2c62cb9 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';
    
        async function convertToInteractive(key) {
          const element = document.querySelector('#df-0ac1b74a-85fd-4f7b-8e07-1516b2c62cb9');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;
    
          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
df_std = scaler.fit_transform(df)

pd.DataFrame(df_std, columns = ['x1_std', 'x2_std'])
```





  <div id="df-cde671f8-6734-49bb-820f-f015ee9259cf">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1_std</th>
      <th>x2_std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.581139</td>
      <td>-1.066004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.264911</td>
      <td>-1.035546</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.948683</td>
      <td>-0.944175</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.632456</td>
      <td>-0.791888</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.316228</td>
      <td>-0.578688</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.000000</td>
      <td>-0.304572</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.316228</td>
      <td>0.030457</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.632456</td>
      <td>0.426401</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.948683</td>
      <td>0.883260</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.264911</td>
      <td>1.401033</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.581139</td>
      <td>1.979721</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-cde671f8-6734-49bb-820f-f015ee9259cf')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }
    
    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }
    
    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }
    
    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-cde671f8-6734-49bb-820f-f015ee9259cf button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';
    
        async function convertToInteractive(key) {
          const element = document.querySelector('#df-cde671f8-6734-49bb-820f-f015ee9259cf');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;
    
          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
from sklearn.preprocessing import Normalizer

scaler = Normalizer()
df_Nml = scaler.fit_transform(df)

pd.DataFrame(df_Nml, columns = ['x1_std', 'x2_std'])
```





  <div id="df-767aa5ea-6f3a-48a9-81f9-4a1285c6830b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1_std</th>
      <th>x2_std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.707107</td>
      <td>0.707107</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.447214</td>
      <td>0.894427</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.316228</td>
      <td>0.948683</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.242536</td>
      <td>0.970143</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.196116</td>
      <td>0.980581</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.164399</td>
      <td>0.986394</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.141421</td>
      <td>0.989949</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.124035</td>
      <td>0.992278</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.110432</td>
      <td>0.993884</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.099504</td>
      <td>0.995037</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-767aa5ea-6f3a-48a9-81f9-4a1285c6830b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }
    
    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }
    
    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }
    
    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-767aa5ea-6f3a-48a9-81f9-4a1285c6830b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';
    
        async function convertToInteractive(key) {
          const element = document.querySelector('#df-767aa5ea-6f3a-48a9-81f9-4a1285c6830b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;
    
          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler()
df_minmax = scaler.fit_transform(df)

pd.DataFrame(df_minmax, columns = ['x1_minmax', 'x2_minmax'])
```





  <div id="df-6acc5656-a418-4470-9bb3-b54032403500">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1_minmax</th>
      <th>x2_minmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.2</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.3</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>0.16</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.6</td>
      <td>0.36</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7</td>
      <td>0.49</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.8</td>
      <td>0.64</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.9</td>
      <td>0.81</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.0</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6acc5656-a418-4470-9bb3-b54032403500')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }
    
    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }
    
    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }
    
    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6acc5656-a418-4470-9bb3-b54032403500 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';
    
        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6acc5656-a418-4470-9bb3-b54032403500');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;
    
          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
from sklearn.preprocessing import RobustScaler

scaler = RobustScaler()
df_robust = scaler.fit_transform(df)

pd.DataFrame(df_robust, columns = ['x1_robust', 'x2_robust'])
```





  <div id="df-bcc0c67b-94f3-4ad1-aa96-149d1e2df7da">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1_robust</th>
      <th>x2_robust</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.0</td>
      <td>-0.50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.8</td>
      <td>-0.48</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.6</td>
      <td>-0.42</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.4</td>
      <td>-0.32</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.2</td>
      <td>-0.18</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.2</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.4</td>
      <td>0.48</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.6</td>
      <td>0.78</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.8</td>
      <td>1.12</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.0</td>
      <td>1.50</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-bcc0c67b-94f3-4ad1-aa96-149d1e2df7da')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }
    
    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }
    
    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }
    
    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-bcc0c67b-94f3-4ad1-aa96-149d1e2df7da button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';
    
        async function convertToInteractive(key) {
          const element = document.querySelector('#df-bcc0c67b-94f3-4ad1-aa96-149d1e2df7da');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;
    
          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




## 이외 질문사항 (index를 datetime 형식으로 채워주고 싶다.)


```python
import pandas as pd
day_index = []
date_index = []
print(date_index)

# 평일 데이터 만들어 주고
dates = pd.date_range('2020-01-01','2020-01-24',freq='B')
# print(dates)
# datetime -> str로 형변환 뒤에 시간 붙여주기 위해서
dates = dates.astype(str)

for b_day in dates:
    start_date = b_day[:10] + ' 09:00:00' # 뽑아준 날짜 들에 시작 시간 붙이기
    end_date = b_day[:10] +' 15:31:00'    # 뽑아준 날짜 들에 끝 시간 붙이기
    range = pd.date_range(start_date, end_date, freq='min') # 1분 단위로 만들어 주기
    range = range.astype(str).tolist() # 형변환 밑 리스트 형으로 변환
    date_index.extend(range)
#     print(date_index)
#     break;
    
df_1 = pd.DataFrame(index = date_index)
df_1['column111'] = 1
print(df_1)
```

    []
                         column111
    2020-01-01 09:00:00          1
    2020-01-01 09:01:00          1
    2020-01-01 09:02:00          1
    2020-01-01 09:03:00          1
    2020-01-01 09:04:00          1
    ...                        ...
    2020-01-24 15:27:00          1
    2020-01-24 15:28:00          1
    2020-01-24 15:29:00          1
    2020-01-24 15:30:00          1
    2020-01-24 15:31:00          1
    
    [7056 rows x 1 columns]

