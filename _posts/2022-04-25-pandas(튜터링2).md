---
title: "튜터링 2일차(Pandas 기초)"
excerpt_separator: "<!--more-->"
categories:

  - Post Formats

tags:

  - python
  - 튜터링
---





# Pandas

### pandas 이용해서 데이터 만들기, 빈데이터에 추가하기, 데이터 합치기


```python
import pandas as pd

#1번째 방법
data = {
    '종목코드': ['037730', '036360', '005760'],
    '종목명': ['3R', '3SOFT', 'ACTS'],
    '현재가': [1510, 1790, 1185]
}
df = pd.DataFrame(data)           # DataFrame 클래스의 객체 생성 (생성자 호출)
print("1번째 방법\n",df)

#2번째 방법
df2 = pd.DataFrame({
    '종목코드': ['037730', '036360', '005760'],
    '종목명': ['3R', '3SOFT', 'ACTS'],
    '현재가': [1510, 1790, 1185]
}) 
print("\n2번째 방법\n",df2)

# 3번째 방법
data2 = [
    ["3R", 1510, 7.36],
    ["3SOFT", 1790, 1.65],
    ["ACTS", 1185, 1.28],
]
index = ["037730", "036360", "005760"]
columns = ["종목명", "현재가", "등락률"]

df3 = pd.DataFrame(data=data2, index=index, columns=columns)
df3.index.name = "종목코드"
print("\n3번째 방법\n",df3)

##########################################
#기존의 데이터를 합치는 방법으로 생성
##########################################
#4번째 Series , append 이용 방법
df_s = pd.DataFrame(columns = df3.columns)
s = pd.Series(data=["3R", 1510,7.36], index=df3.columns)
df_s.loc["066570"] = s
df_s.loc["036360"] = ["3SOFT", 1790,1.65]
s = pd.Series(data=["ACTS", 1185,1.28], index=df3.columns, name="005760")
df_s = df_s.append(s)
print("\n4번째 Series 사용 방법\n",df_s)

#5번째 append 이용 방법 
df4 = pd.DataFrame(columns = df3.columns) # df2의 칼럼만 복사
df4 = df4.append({'종목코드' :'037730','종목명': '3R' ,'현재가': 1510 },ignore_index=True)
df4 = df4.append({'종목코드' :'036360','종목명': '3SOFT' ,'현재가': 1790 },ignore_index=True)
df4 = df4.append({'종목코드' :'005760','종목명': 'ACTS' ,'현재가': 1185 },ignore_index=True)
print("\n5번째 append 사용 방법\n",df4)

#6번째 방법 concat에 join을 넣어줘서 어느 쪽에 있는 것만 합칠 수도 있음. 
df5 = pd.DataFrame({'종목코드' :['037730'],'종목명': ['3R'] ,'현재가': [1510] })
df6 = pd.DataFrame({'종목코드' :['036360','005760'],'종목명': ['3SOFT','ACTS'] ,'현재가': [1790 , 1185]})
df7 = pd.concat([df5,df6], axis=0)       #행방향
df8 = pd.concat([df5,df6], axis=1)       #열방향
print("\n6번째 concat axis=0 일때 방법\n",df7)
print("\n6번째 concat axis=1 일때 방법\n",df8)

#7번째 방법 
df9 = pd.merge(df5,df6, how='outer', left_index=False, right_index=False)
print("\n7번째 merge 방법 \n",df9)
```

    1번째 방법
          종목코드    종목명   현재가
    0  037730     3R  1510
    1  036360  3SOFT  1790
    2  005760   ACTS  1185
    
    2번째 방법
          종목코드    종목명   현재가
    0  037730     3R  1510
    1  036360  3SOFT  1790
    2  005760   ACTS  1185
    
    3번째 방법
               종목명   현재가   등락률
    종목코드                     
    037730     3R  1510  7.36
    036360  3SOFT  1790  1.65
    005760   ACTS  1185  1.28
    
    4번째 Series 사용 방법
               종목명   현재가   등락률
    066570     3R  1510  7.36
    036360  3SOFT  1790  1.65
    005760   ACTS  1185  1.28
    
    5번째 append 사용 방법
          종목명   현재가  등락률    종목코드
    0     3R  1510  NaN  037730
    1  3SOFT  1790  NaN  036360
    2   ACTS  1185  NaN  005760
    
    6번째 concat axis=0 일때 방법
          종목코드    종목명   현재가
    0  037730     3R  1510
    0  036360  3SOFT  1790
    1  005760   ACTS  1185
    
    6번째 concat axis=1 일때 방법
          종목코드  종목명     현재가    종목코드    종목명   현재가
    0  037730   3R  1510.0  036360  3SOFT  1790
    1     NaN  NaN     NaN  005760   ACTS  1185
    
    7번째 merge 방법 
          종목코드    종목명   현재가
    0  037730     3R  1510
    1  036360  3SOFT  1790
    2  005760   ACTS  1185


### 인덱스 


```python
print("원본\n", df9, "\n")
df9 = df9.set_index('종목코드')
print("index 변경후\n",df9, "\n")
df9 = df9.reset_index()
print("reset 후\n",df9,"\n")
```

    원본
          종목코드    종목명   현재가
    0  037730     3R  1510
    1  036360  3SOFT  1790
    2  005760   ACTS  1185 
    
    index 변경후
               종목명   현재가
    종목코드               
    037730     3R  1510
    036360  3SOFT  1790
    005760   ACTS  1185 
    
    reset 후
          종목코드    종목명   현재가
    0  037730     3R  1510
    1  036360  3SOFT  1790
    2  005760   ACTS  1185 


​    

### 칼럼 인덱싱, 슬라이싱


```python
# 종목코드에 해당하는 현재가 칼럼만 받아오기
df9 = df9.set_index('종목코드')
print(df9[ '현재가' ])      # 시리즈로 반환  인덱싱
print(type(df9[ '현재가' ]))
print(df9[ [ '현재가' ] ])    # 데이터프레임으로 반환  슬라이싱
print(type(df9[ [ '현재가' ] ]))
```

    종목코드
    037730    1510
    036360    1790
    005760    1185
    Name: 현재가, dtype: int64
    <class 'pandas.core.series.Series'>
             현재가
    종목코드        
    037730  1510
    036360  1790
    005760  1185
    <class 'pandas.core.frame.DataFrame'>


### 로우 인덱싱, 슬라이싱 (loc, iloc)
 - loc 인덱스를 기준으로 로우 데이터 추출
 - iloc 행 번호를 기준으로 로우 데이터 추출


```python
import pandas as pd
data = [
    ["3R", 1510, 7.36],
    ["3SOFT", 1790, 1.65],
    ["ACTS", 1185, 1.28]
]

index = ["037730", "036360", "005760"]
columns = ["종목명", "현재가", "등락률"]
df = pd.DataFrame(data=data, index=index, columns=columns)
# 인덱싱
print("인덱싱\nloc\n",df.loc["037730"])
print("\niloc\n",df.iloc[ 0 ])

#슬라이싱
print("\n슬라이싱\nloc\n",df.loc[ [ "037730", "036360" ] ])
print("\niloc\n",df.iloc[ [ 0, 1 ] ])
```

    인덱싱
    loc
     종목명      3R
    현재가    1510
    등락률    7.36
    Name: 037730, dtype: object
    
    iloc
     종목명      3R
    현재가    1510
    등락률    7.36
    Name: 037730, dtype: object
    
    슬라이싱
    loc
               종목명   현재가   등락률
    037730     3R  1510  7.36
    036360  3SOFT  1790  1.65
    
    iloc
               종목명   현재가   등락률
    037730     3R  1510  7.36
    036360  3SOFT  1790  1.65



```python
# 같이 사용가능
# 행 번호로 행 선택 후 시리즈 인덱싱 
print(df.iloc[0].iloc[1])               # 시리즈 행 번호
print(df.iloc[0][1])
print(df.iloc[0].loc["현재가"])         # 시리즈 인덱스 
print(df.iloc[0]["현재가"])            # 시리즈 인덱스
print(df.iloc[0, 1])

# 인덱스로 행 선택 후 시리즈 인덱싱 
print(df.loc["037730"].iloc[1])        # 시리즈 행 번호
print(df.loc["037730"].loc["현재가"])  # 시리즈 인덱스 
print(df.loc["037730"]["현재가"])     # 시리즈 인덱스
print(df.loc["037730", "현재가"])
print(df["현재가"]["037730"])
```

    1510
    1510
    1510
    1510
    1510
    1510
    1510
    1510
    1510
    1510



```python
# 특정행 가져오기
print(df.iloc[[0, 1], [0, 1]])
print(df.loc[["037730", "036360"], ["종목명", "현재가"]])
```

              종목명   현재가
    037730     3R  1510
    036360  3SOFT  1790
              종목명   현재가
    037730     3R  1510
    036360  3SOFT  1790



```python
# 1500 이상의 값만 받아오기
temp = df['현재가'] >= 1500
print(df.loc[temp],"\n")
print(df.loc[df['현재가'] >= 1500],"\n")

print(df.loc[~temp])
```

              종목명   현재가   등락률
    037730     3R  1510  7.36
    036360  3SOFT  1790  1.65 
    
              종목명   현재가   등락률
    037730     3R  1510  7.36
    036360  3SOFT  1790  1.65 
    
             종목명   현재가   등락률
    005760  ACTS  1185  1.28



```python
# 현재가만 받아오기
print(df.loc[temp]["현재가"])
print(df.loc[temp, "현재가"])
```

    037730    1510
    036360    1790
    Name: 현재가, dtype: int64
    037730    1510
    036360    1790
    Name: 현재가, dtype: int64



```python
temp = (df['현재가'] >= 1500) & (df['현재가'] < 1700)
print("==== 데이터 어떻게 나오는지 확인 \n",df['현재가'] >= 1500)
print(df['현재가'] < 1700,"\n==================")

print(df.loc[temp],"\n")
print(df.loc[(df['현재가'] >= 1500) & (df['현재가'] < 1700)],"\n")
print(df[(df['현재가'] >= 1500) & (df['현재가'] < 1700)],"\n")

print(df.loc[~temp])
```

    ==== 데이터 어떻게 나오는지 확인 
     037730     True
    036360     True
    005760    False
    Name: 현재가, dtype: bool
    037730     True
    036360    False
    005760     True
    Name: 현재가, dtype: bool 
    ==================
           종목명   현재가   등락률
    037730  3R  1510  7.36 
    
           종목명   현재가   등락률
    037730  3R  1510  7.36 
    
           종목명   현재가   등락률
    037730  3R  1510  7.36 
    
              종목명   현재가   등락률
    036360  3SOFT  1790  1.65
    005760   ACTS  1185  1.28


### 칼럼 추가


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>현재가</th>
      <th>등락률</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>037730</th>
      <td>3R</td>
      <td>1510</td>
      <td>7.36</td>
    </tr>
    <tr>
      <th>036360</th>
      <td>3SOFT</td>
      <td>1790</td>
      <td>1.65</td>
    </tr>
    <tr>
      <th>005760</th>
      <td>ACTS</td>
      <td>1185</td>
      <td>1.28</td>
    </tr>
  </tbody>
</table>
</div>




```python
#round 활용 (반올림 함수)
cash = 100000
df['비중'] = round(100/3,1)
df['투입금액'] = round(cash * df['비중']/100, -2)
df['보유주식수'] = round( df['투입금액']/ df['현재가'] ,2)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>현재가</th>
      <th>등락률</th>
      <th>비중</th>
      <th>투입금액</th>
      <th>보유주식수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>037730</th>
      <td>3R</td>
      <td>1510</td>
      <td>7.36</td>
      <td>33.3</td>
      <td>33300.0</td>
      <td>22.05</td>
    </tr>
    <tr>
      <th>036360</th>
      <td>3SOFT</td>
      <td>1790</td>
      <td>1.65</td>
      <td>33.3</td>
      <td>33300.0</td>
      <td>18.60</td>
    </tr>
    <tr>
      <th>005760</th>
      <td>ACTS</td>
      <td>1185</td>
      <td>1.28</td>
      <td>33.3</td>
      <td>33300.0</td>
      <td>28.10</td>
    </tr>
  </tbody>
</table>
</div>



### 삭제하기


```python
df = df.drop('현재가', axis=1)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>등락률</th>
      <th>비중</th>
      <th>투입금액</th>
      <th>보유주식수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>037730</th>
      <td>3R</td>
      <td>7.36</td>
      <td>33.3</td>
      <td>33300.0</td>
      <td>22.05</td>
    </tr>
    <tr>
      <th>036360</th>
      <td>3SOFT</td>
      <td>1.65</td>
      <td>33.3</td>
      <td>33300.0</td>
      <td>18.60</td>
    </tr>
    <tr>
      <th>005760</th>
      <td>ACTS</td>
      <td>1.28</td>
      <td>33.3</td>
      <td>33300.0</td>
      <td>28.10</td>
    </tr>
  </tbody>
</table>
</div>




```python
df = df.drop("005760", axis=0)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목명</th>
      <th>등락률</th>
      <th>비중</th>
      <th>투입금액</th>
      <th>보유주식수</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>037730</th>
      <td>3R</td>
      <td>7.36</td>
      <td>33.3</td>
      <td>33300.0</td>
      <td>22.05</td>
    </tr>
    <tr>
      <th>036360</th>
      <td>3SOFT</td>
      <td>1.65</td>
      <td>33.3</td>
      <td>33300.0</td>
      <td>18.60</td>
    </tr>
  </tbody>
</table>
</div>




```python
data123 = {
    '종목코드': ['037730', '036360', '005760','000821','149231'],
    '종목명': ['3R', '3SOFT', 'ACTS', 'abc','bcd'],
    '현재가': [1510, 1790, 1185, 1231 , 5643]
}
index1 = [1 , 2 , 3, 4 , 5]
df123 = pd.DataFrame(data = data123, index = index1)
df123
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>현재가</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>037730</td>
      <td>3R</td>
      <td>1510</td>
    </tr>
    <tr>
      <th>2</th>
      <td>036360</td>
      <td>3SOFT</td>
      <td>1790</td>
    </tr>
    <tr>
      <th>3</th>
      <td>005760</td>
      <td>ACTS</td>
      <td>1185</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000821</td>
      <td>abc</td>
      <td>1231</td>
    </tr>
    <tr>
      <th>5</th>
      <td>149231</td>
      <td>bcd</td>
      <td>5643</td>
    </tr>
  </tbody>
</table>
</div>




```python
df123 = df123.drop(2, axis=0) # 인덱스 2 삭제
df123
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>현재가</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>037730</td>
      <td>3R</td>
      <td>1510</td>
    </tr>
    <tr>
      <th>3</th>
      <td>005760</td>
      <td>ACTS</td>
      <td>1185</td>
    </tr>
    <tr>
      <th>4</th>
      <td>000821</td>
      <td>abc</td>
      <td>1231</td>
    </tr>
    <tr>
      <th>5</th>
      <td>149231</td>
      <td>bcd</td>
      <td>5643</td>
    </tr>
  </tbody>
</table>
</div>




```python
drop_list = [1,4]
df123 = df123.drop([1,4], axis=0) 
df123
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>종목명</th>
      <th>현재가</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>005760</td>
      <td>ACTS</td>
      <td>1185</td>
    </tr>
    <tr>
      <th>5</th>
      <td>149231</td>
      <td>bcd</td>
      <td>5643</td>
    </tr>
  </tbody>
</table>
</div>



### GroupBy


```python
data = [
    ["2차전지(생산)", "SK이노베이션", 10.19, 1.29],
    ["해운", "팬오션", 21.23, 0.95],
    ["시스템반도체", "티엘아이", 35.97, 1.12],
    ["해운", "HMM", 21.52, 3.20],
    ["시스템반도체", "아이에이", 37.32, 3.55],
    ["2차전지(생산)", "LG화학", 83.06, 3.75]
]

columns = ["테마", "종목명", "PER", "PBR"]
df = pd.DataFrame(data=data, columns=columns)
df1 = df[df['테마'] == "2차전지(생산)"]
df2 = df[df['테마'] == "해운"]
df3 = df[df['테마'] == "시스템반도체"]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>테마</th>
      <th>종목명</th>
      <th>PER</th>
      <th>PBR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2차전지(생산)</td>
      <td>SK이노베이션</td>
      <td>10.19</td>
      <td>1.29</td>
    </tr>
    <tr>
      <th>1</th>
      <td>해운</td>
      <td>팬오션</td>
      <td>21.23</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>2</th>
      <td>시스템반도체</td>
      <td>티엘아이</td>
      <td>35.97</td>
      <td>1.12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>해운</td>
      <td>HMM</td>
      <td>21.52</td>
      <td>3.20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>시스템반도체</td>
      <td>아이에이</td>
      <td>37.32</td>
      <td>3.55</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2차전지(생산)</td>
      <td>LG화학</td>
      <td>83.06</td>
      <td>3.75</td>
    </tr>
  </tbody>
</table>
</div>



### 문제 각 테마별로 PER 평균 구하고 해당 테마별로 시리즈에 저장해보세요.


```python
mean1 = df1['PER'].mean()
mean2 = df2['PER'].mean()   
mean3 = df3['PER'].mean()

data = [mean1, mean2, mean3]
index = ["2차전지(생산)", "해운", "시스템반도체"]
s = pd.Series(data=data, index=index)
# ss = pd.Series({"2차전지(생산)":mean1, "해운":mean2, "시스템반도체":mean3})
# print(ss)
print(s)
```

    2차전지(생산)    46.625
    해운          21.375
    시스템반도체      36.645
    dtype: float64



```python
# 위 과정을 한번에
# df.groupby("테마")["PER"].mean()
df.groupby(['테마', 'PER']).mean()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PBR</th>
    </tr>
    <tr>
      <th>테마</th>
      <th>PER</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2차전지(생산)</th>
      <th>10.19</th>
      <td>1.29</td>
    </tr>
    <tr>
      <th>83.06</th>
      <td>3.75</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">시스템반도체</th>
      <th>35.97</th>
      <td>1.12</td>
    </tr>
    <tr>
      <th>37.32</th>
      <td>3.55</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">해운</th>
      <th>21.23</th>
      <td>0.95</td>
    </tr>
    <tr>
      <th>21.52</th>
      <td>3.20</td>
    </tr>
  </tbody>
</table>
</div>



### DataFrame 저장

#### CSV 파일로 저장 (csv 파일 용량이 작기 때문에 excel보다 csv확장자 사용 추천)


```python
# CSV파일로 저장하기
data = [
    ["2차전지(생산)", "SK이노베이션", 10.19, 1.29],
    ["해운", "팬오션", 21.23, 0.95],
    ["시스템반도체", "티엘아이", 35.97, 1.12],
    ["해운", "HMM", 21.52, 3.20],
    ["시스템반도체", "아이에이", 37.32, 3.55],
    ["2차전지(생산)", "LG화학", 83.06, 3.75]
]
columns = ["테마", "종목명", "PER", "PBR"]
df = pd.DataFrame(data=data, columns=columns)

df.to_csv("test.csv",sep=',', na_rep='NaN', encoding='cp949')  
# index=False, 넣어보고 차이점 비교 , seperator, delimiter (구분자)
"""
encoding 옵션: csv 파일에서 한글 (컬럼 혹은 내용) 읽어올 때 
encoding='cp949' (혹은 encoding='euc-kr') 옵션 사용, 엑셀의 csv 파일 utf-8 인코딩 (유니코드) 인식 버그
"""
# CSV파일 읽기

df1 = pd.read_csv("test.csv", encoding='cp949')
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>테마</th>
      <th>종목명</th>
      <th>PER</th>
      <th>PBR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2차전지(생산)</td>
      <td>SK이노베이션</td>
      <td>10.19</td>
      <td>1.29</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>해운</td>
      <td>팬오션</td>
      <td>21.23</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>시스템반도체</td>
      <td>티엘아이</td>
      <td>35.97</td>
      <td>1.12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>해운</td>
      <td>HMM</td>
      <td>21.52</td>
      <td>3.20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>시스템반도체</td>
      <td>아이에이</td>
      <td>37.32</td>
      <td>3.55</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>2차전지(생산)</td>
      <td>LG화학</td>
      <td>83.06</td>
      <td>3.75</td>
    </tr>
  </tbody>
</table>
</div>



### 실습 Unnamed: 0 칼럼 이름을 number로 바꿔보고 인덱스로 변경 해보기기


```python
# 데이터프레임.rename(columns = {'Unnamed: 0' : '원하는 칼럼 이름'}, inplace = True)
df1.rename(columns = {'Unnamed: 0' : 'number'}, inplace = True)
df1 = df1.set_index('number')
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>테마</th>
      <th>종목명</th>
      <th>PER</th>
      <th>PBR</th>
    </tr>
    <tr>
      <th>number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2차전지(생산)</td>
      <td>SK이노베이션</td>
      <td>10.19</td>
      <td>1.29</td>
    </tr>
    <tr>
      <th>1</th>
      <td>해운</td>
      <td>팬오션</td>
      <td>21.23</td>
      <td>0.95</td>
    </tr>
    <tr>
      <th>2</th>
      <td>시스템반도체</td>
      <td>티엘아이</td>
      <td>35.97</td>
      <td>1.12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>해운</td>
      <td>HMM</td>
      <td>21.52</td>
      <td>3.20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>시스템반도체</td>
      <td>아이에이</td>
      <td>37.32</td>
      <td>3.55</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2차전지(생산)</td>
      <td>LG화학</td>
      <td>83.06</td>
      <td>3.75</td>
    </tr>
  </tbody>
</table>
</div>



#### excel 파일로 저장 (파일이 커서 저장, 불러오기 데이티어가 많아 질 수록 느려진다)


```python
# 엑셀로 저장하기

df.to_excel("test.xlsx")

# 엑셀파일 읽기

df = pd.read_excel("test.xlsx")
```

### pickle, html, SQLite3 DB로 저장하기 방법이 더 있지만 필요하면 google에 찾아보시면 되겠습니다.

### 시간 날짜 datetime 형식으로 바꾸기


```python
from datetime import datetime
df = pd.DataFrame(data=[20161011, 20171013, 20181031], columns=["d"])
print("========전")
print(df.info(),"\n")

print("칼럼 d 타입",df["d"].dtype)
df["d"] = df["d"].astype(str)      # int -> str(object) 데이터 타입 변경
print("칼럼 d 타입",df["d"].dtype)

df["date"] = df["d"].str[0:4] + "-" + df["d"].str[4:6] + "-" + df["d"].str[6:8]
df["date"] = df["date"].astype('datetime64[ns]') # str(object) -> datetime64[ns] 데이터 타입 변경
df['date1'] = df["date"].dt.strftime("%Y/%m/%d") # datetime64[ns] -> str(object) 형식으로 변경
df['date2'] = pd.to_datetime(df['date'], infer_datetime_format=True) # str(object) -> datetime64[ns] 데이터 타입 변경
print("\n변경된 date\n",df,"\n")
print("칼럼 date 타입",df["date"].dtype,"\n")

print("========후")
print(df.info())
```

    ========전
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 3 entries, 0 to 2
    Data columns (total 1 columns):
     #   Column  Non-Null Count  Dtype
    ---  ------  --------------  -----
     0   d       3 non-null      int64
    dtypes: int64(1)
    memory usage: 152.0 bytes
    None 
    
    칼럼 d 타입 int64
    칼럼 d 타입 object
    
    변경된 date
               d       date       date1      date2
    0  20161011 2016-10-11  2016/10/11 2016-10-11
    1  20171013 2017-10-13  2017/10/13 2017-10-13
    2  20181031 2018-10-31  2018/10/31 2018-10-31 
    
    칼럼 date 타입 datetime64[ns] 
    
    ========후
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 3 entries, 0 to 2
    Data columns (total 4 columns):
     #   Column  Non-Null Count  Dtype         
    ---  ------  --------------  -----         
     0   d       3 non-null      object        
     1   date    3 non-null      datetime64[ns]
     2   date1   3 non-null      object        
     3   date2   3 non-null      datetime64[ns]
    dtypes: datetime64[ns](2), object(2)
    memory usage: 224.0+ bytes
    None



```python
df['date3'] = df['date1'].str[2:4]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
      <th>date</th>
      <th>date1</th>
      <th>date2</th>
      <th>date3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20161011</td>
      <td>2016-10-11</td>
      <td>2016/10/11</td>
      <td>2016-10-11</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20171013</td>
      <td>2017-10-13</td>
      <td>2017/10/13</td>
      <td>2017-10-13</td>
      <td>17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20181031</td>
      <td>2018-10-31</td>
      <td>2018/10/31</td>
      <td>2018-10-31</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div>




```python
# date_range나 period_range함수를 이용하면 특정기간에 대해 일정한 간격으로 데이터를 만들 수 있다.
print(pd.Series(pd.date_range('2000', freq='D', periods=3)))
print(pd.Series(pd.date_range('1/1/2011', freq='M', periods=3)))
print(pd.Series(pd.period_range('1/1/2011', freq='Y', periods=3)))

print(pd.date_range(start='2020-10-01', end='2020-10-20', periods=5))
```

    0   2000-01-01
    1   2000-01-02
    2   2000-01-03
    dtype: datetime64[ns]
    0   2011-01-31
    1   2011-02-28
    2   2011-03-31
    dtype: datetime64[ns]
    0    2011
    1    2012
    2    2013
    dtype: period[A-DEC]
    DatetimeIndex(['2020-10-01 00:00:00', '2020-10-05 18:00:00',
                   '2020-10-10 12:00:00', '2020-10-15 06:00:00',
                   '2020-10-20 00:00:00'],
                  dtype='datetime64[ns]', freq=None)


### 날짜 시간 더하거나 빼기기


```python
print(df)
df["date_1m"] = df["date"] + pd.DateOffset(months=1)
print(df["date_1m"])
df["date_1d"] = df["date"] + pd.DateOffset(days=1)
print(df["date_1d"])
df["date_1y"] = df["date"] + pd.DateOffset(years=1)
print(df["date_1y"])
```

              d       date       date1      date2 date3
    0  20161011 2016-10-11  2016/10/11 2016-10-11    16
    1  20171013 2017-10-13  2017/10/13 2017-10-13    17
    2  20181031 2018-10-31  2018/10/31 2018-10-31    18
    0   2016-11-11
    1   2017-11-13
    2   2018-11-30
    Name: date_1m, dtype: datetime64[ns]
    0   2016-10-12
    1   2017-10-14
    2   2018-11-01
    Name: date_1d, dtype: datetime64[ns]
    0   2017-10-11
    1   2018-10-13
    2   2019-10-31
    Name: date_1y, dtype: datetime64[ns]



```python
df["date_m"] = df["date_1d"] - df["date"]
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>d</th>
      <th>date</th>
      <th>date1</th>
      <th>date2</th>
      <th>date3</th>
      <th>date_1m</th>
      <th>date_1d</th>
      <th>date_1y</th>
      <th>date_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20161011</td>
      <td>2016-10-11</td>
      <td>2016/10/11</td>
      <td>2016-10-11</td>
      <td>16</td>
      <td>2016-11-11</td>
      <td>2016-10-12</td>
      <td>2017-10-11</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20171013</td>
      <td>2017-10-13</td>
      <td>2017/10/13</td>
      <td>2017-10-13</td>
      <td>17</td>
      <td>2017-11-13</td>
      <td>2017-10-14</td>
      <td>2018-10-13</td>
      <td>1 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20181031</td>
      <td>2018-10-31</td>
      <td>2018/10/31</td>
      <td>2018-10-31</td>
      <td>18</td>
      <td>2018-11-30</td>
      <td>2018-11-01</td>
      <td>2019-10-31</td>
      <td>1 days</td>
    </tr>
  </tbody>
</table>
</div>



### 필요한 날짜와 시간 정의 찾기


```python
# "데이터프레임명[칼럼명].dt.항목명" 과 같이 사용
df["date"].dt.year
```




    0    2016
    1    2017
    2    2018
    Name: date, dtype: int64



![날짜와 시간 Property](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=http%3A%2F%2Fcfile30.uf.tistory.com%2Fimage%2F994F8D375CD9DFA71358A8)

### Merge
- merge 함수는 두 데이터 프레임의 공통 열 혹은 인덱스를 기준으로 두 개의 테이블을 합친다.
  이 때 기준이 되는 열, 행의 데이터를 키(key)라고 한다
- pd.merge(df_left, df_right, how='inner', on=None)
  두개의 데이터프레임에서 key 값의 이름이 다를 때(기준열 이름이 다를 때) left_on = ' ' ,right_on = ' '으로 
  on= ' ' 대체 가능함
- 조인 방식 , how(default는 inner)
    - outer 양쪽 키값에 해당하는 값이 없어도 전체 합치기
    - inner 양쪽에 겹치는 값만 합치기
    - left  왼쪽 데이터프레임을 기준으로 합치기
    - right 오른쪽 데이터프레임을 기준으로 합치기

![KakaoTalk_20220421_161021807](https://user-images.githubusercontent.com/92857078/164399948-98d552b6-4e2d-4801-b0f7-a77c0f70fb26.png)



```python
df1 = pd.DataFrame({
    '고객번호': [1001, 1002, 1003, 1004, 1005, 1006, 1007],
    '이름': ['둘리', '도우너', '또치', '길동', '희동', '마이콜', '영희']
}, columns=['고객번호', '이름'])


df1_rl = pd.DataFrame({
    '고객번호1': [1001, 1002, 1003, 1004, 1005, 1006, 1007],
    '이름': ['둘리', '도우너', '또치', '길동', '희동', '마이콜', '영희']
}, columns=['고객번호1', '이름'])
df1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객번호</th>
      <th>이름</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>둘리</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1002</td>
      <td>도우너</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1003</td>
      <td>또치</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1004</td>
      <td>길동</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1005</td>
      <td>희동</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1006</td>
      <td>마이콜</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1007</td>
      <td>영희</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2 = pd.DataFrame({
    '고객번호': [1001, 1001, 1005, 1006, 1008, 1001],
    '금액': [10000, 20000, 15000, 5000, 100000, 30000]
}, columns=['고객번호', '금액'])

df2_rl = pd.DataFrame({
    '고객번호': [1001, 1001, 1005, 1006, 1008, 1001],
    '금액': [10000, 20000, 15000, 5000, 100000, 30000]
}, columns=['고객번호', '금액'])

df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객번호</th>
      <th>금액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1001</td>
      <td>20000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1005</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1006</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1008</td>
      <td>100000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1001</td>
      <td>30000</td>
    </tr>
  </tbody>
</table>
</div>




```python
'''
merge 함수로 위의 두 데이터프레임 df1, df2 를 합치면 공통 열인 고객번호 열을 기준으로 데이터를 찾아서 합친다. 
이 때 기본적으로는 양쪽 데이터프레임에 모두 키가 존재하는 데이터만 보여주는 inner join 방식을 사용한다.
'''
pd.merge(df1_rl, df2_rl , left_on='고객번호1',right_on='고객번호')

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객번호1</th>
      <th>이름</th>
      <th>고객번호</th>
      <th>금액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>둘리</td>
      <td>1001</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1001</td>
      <td>둘리</td>
      <td>1001</td>
      <td>20000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1001</td>
      <td>둘리</td>
      <td>1001</td>
      <td>30000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1005</td>
      <td>희동</td>
      <td>1005</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1006</td>
      <td>마이콜</td>
      <td>1006</td>
      <td>5000</td>
    </tr>
  </tbody>
</table>
</div>




```python
# outer join 방식은 키 값이 한쪽에만 있어도 데이터를 보여준다. 
pd.merge(df1, df2, how='outer', on='고객번호')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객번호</th>
      <th>이름</th>
      <th>금액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>둘리</td>
      <td>10000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1001</td>
      <td>둘리</td>
      <td>20000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1001</td>
      <td>둘리</td>
      <td>30000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1002</td>
      <td>도우너</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1003</td>
      <td>또치</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1004</td>
      <td>길동</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1005</td>
      <td>희동</td>
      <td>15000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1006</td>
      <td>마이콜</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1007</td>
      <td>영희</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1008</td>
      <td>NaN</td>
      <td>100000.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# left, right 방식은 각각 첫번째, 혹은 두번째 데이터프레임의 키 값을 모두 보여준다.
pd.merge(df1, df2, how='left', on='고객번호')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객번호</th>
      <th>이름</th>
      <th>금액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>둘리</td>
      <td>10000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1001</td>
      <td>둘리</td>
      <td>20000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1001</td>
      <td>둘리</td>
      <td>30000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1002</td>
      <td>도우너</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1003</td>
      <td>또치</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1004</td>
      <td>길동</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1005</td>
      <td>희동</td>
      <td>15000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1006</td>
      <td>마이콜</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1007</td>
      <td>영희</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.merge(df1, df2, how='right', on='고객번호')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>고객번호</th>
      <th>이름</th>
      <th>금액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>둘리</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1001</td>
      <td>둘리</td>
      <td>20000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1005</td>
      <td>희동</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1006</td>
      <td>마이콜</td>
      <td>5000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1008</td>
      <td>NaN</td>
      <td>100000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1001</td>
      <td>둘리</td>
      <td>30000</td>
    </tr>
  </tbody>
</table>
</div>



### 실습  아래 두 데이터를 이용해서 merge 4가지 방법으로 합쳐보고(회사코드는 지워주세요) 차이점을 비교해 보세요.(최종 inner 방법으로 data_test에 저장하세요)


```python
df_name = pd.DataFrame({
    '종목코드': [95570, 68400, 27410, 282330, 138930, 1460],
    '회사이름': ['AJ네트웍스', 'SK렌터카', 'AK홀딩스', 'BGF리테일', 'BNK금융지주', 'BYC']
}, columns=['종목코드', '회사이름'])

df_money = pd.DataFrame({
    '회사코드': [95570, 68400, 6840, 27410, 138930, 1460],
    '종가': [20000, 24000, 15000, 5000, 100000, 30000]
}, columns=['회사코드', '종가'])
print('df_name데이터 \n',df_name,'\n')
print('df_money데이터 \n',df_money)
```

    df_name데이터 
          종목코드     회사이름
    0   95570   AJ네트웍스
    1   68400    SK렌터카
    2   27410    AK홀딩스
    3  282330   BGF리테일
    4  138930  BNK금융지주
    5    1460      BYC 
    
    df_money데이터 
          회사코드      종가
    0   95570   20000
    1   68400   24000
    2    6840   15000
    3   27410    5000
    4  138930  100000
    5    1460   30000



```python
data_test = pd.concat([df_name, df_money,df_name],axis=1)
data_test
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>종목코드</th>
      <th>회사이름</th>
      <th>회사코드</th>
      <th>종가</th>
      <th>종목코드</th>
      <th>회사이름</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>95570</td>
      <td>AJ네트웍스</td>
      <td>95570</td>
      <td>20000</td>
      <td>95570</td>
      <td>AJ네트웍스</td>
    </tr>
    <tr>
      <th>1</th>
      <td>68400</td>
      <td>SK렌터카</td>
      <td>68400</td>
      <td>24000</td>
      <td>68400</td>
      <td>SK렌터카</td>
    </tr>
    <tr>
      <th>2</th>
      <td>27410</td>
      <td>AK홀딩스</td>
      <td>6840</td>
      <td>15000</td>
      <td>27410</td>
      <td>AK홀딩스</td>
    </tr>
    <tr>
      <th>3</th>
      <td>282330</td>
      <td>BGF리테일</td>
      <td>27410</td>
      <td>5000</td>
      <td>282330</td>
      <td>BGF리테일</td>
    </tr>
    <tr>
      <th>4</th>
      <td>138930</td>
      <td>BNK금융지주</td>
      <td>138930</td>
      <td>100000</td>
      <td>138930</td>
      <td>BNK금융지주</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1460</td>
      <td>BYC</td>
      <td>1460</td>
      <td>30000</td>
      <td>1460</td>
      <td>BYC</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 방법1 left_on, right_on 지정해서 합쳐주고 하나 삭제
data_test = pd.merge(df_name, df_money, left_on = '종목코드',right_on='회사코드')
print(data_test,data_test)
data_test = pd.merge(df_name, df_money, how='outer', left_on = '종목코드',right_on='회사코드')
print(data_test)
# data_test = pd.merge(df_name, df_money, how='right', left_on = '종목코드',right_on='회사코드')
# data_test = pd.merge(df_name, df_money, how='left', left_on = '종목코드',right_on='회사코드')
data_test.drop('회사코드',axis=1,inplace=True)
print(data_test)

# 방법2 칼럼 이름을 바꿔주고 진행
# df_money.rename(columns = {'회사코드' : '종목코드'}, inplace = True)
# data_test1 = pd.merge(df_name, df_money, on = '종목코드')
# data_test1 = pd.merge(df_name, df_money, how='outer', on = '종목코드')
# data_test1 = pd.merge(df_name, df_money, how='right', on = '종목코드')
# data_test1 = pd.merge(df_name, df_money, how='left', on = '종목코드')
# print(data_test1)
```

         종목코드     회사이름    회사코드      종가
    0   95570   AJ네트웍스   95570   20000
    1   68400    SK렌터카   68400   24000
    2   27410    AK홀딩스   27410    5000
    3  138930  BNK금융지주  138930  100000
    4    1460      BYC    1460   30000      종목코드     회사이름    회사코드      종가
    0   95570   AJ네트웍스   95570   20000
    1   68400    SK렌터카   68400   24000
    2   27410    AK홀딩스   27410    5000
    3  138930  BNK금융지주  138930  100000
    4    1460      BYC    1460   30000
           종목코드     회사이름      회사코드        종가
    0   95570.0   AJ네트웍스   95570.0   20000.0
    1   68400.0    SK렌터카   68400.0   24000.0
    2   27410.0    AK홀딩스   27410.0    5000.0
    3  282330.0   BGF리테일       NaN       NaN
    4  138930.0  BNK금융지주  138930.0  100000.0
    5    1460.0      BYC    1460.0   30000.0
    6       NaN      NaN    6840.0   15000.0
           종목코드     회사이름        종가
    0   95570.0   AJ네트웍스   20000.0
    1   68400.0    SK렌터카   24000.0
    2   27410.0    AK홀딩스    5000.0
    3  282330.0   BGF리테일       NaN
    4  138930.0  BNK금융지주  100000.0
    5    1460.0      BYC   30000.0
    6       NaN      NaN   15000.0

